---
title: "Global Dietary Trends"
author: "Pooja Rajendran Raju" 
date: "July 1, 2025"
output: 
  html:
    toc: true
    toc_float:
      collapsed: true
categories: [Exploration]
---

```{r setup, include=FALSE}
#| echo: false
# Set up chunk for all slides
knitr::opts_chunk$set(
  #fig.width = 6,
  #fig.height = 4,
  fig.align = "center",
  out.width = "100%",
  code.line.numbers = FALSE,
  fig.retina = 4,
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  dev.args = list(pointsize = 11)
)

library(tidyverse)
library(tarchetypes)
library(targets)

```

```{r}
#| echo: true 
#| code-fold: true

# Load raw data from targets
raw_data <- tar_read(raw_data)

```

## Introduction

This report focuses on the analysis of daily caloric supply derived from carbohydrates, protein, and fat across multiple countries from 1961 to the most recent available year 2022. The objective is to examine global dietary patterns over time, identify regional differences in macronutrient consumption, and explore trends in protein intake from animal-based and plant-based sources.

#### Data

```{r}
#| echo: true 
#| code-fold: true


# Glimpse of data

glimpse(raw_data)
```

Our World in Data is an online platform that provides accessible and comprehensive data on global development issues. The following dataset is used from the platform for analysis:

[Daily caloric supply derived from carbohydrates, protein and fat](https://ourworldindata.org/grapher/daily-caloric-supply-derived-from-carbohydrates-protein-and-fat?tab=table&time=earliest): The dataset, provided by Our World in Data, is sourced from the Food and Agriculture Organization (FAO) of the United Nations. It documents the average daily caloric supply per person derived from three primary macronutrients, carbohydrates, protein, and fat, for numerous countries and regions globally. The data spans several decades, offering valuable insights into nutritional trends and shifts over time.

-   **Source**: Our World in Data – Daily Caloric Supply Derived from Carbohydrates, Protein, and Fat
-   **Data Provider**: Food and Agriculture Organization (FAO), United Nations
-   **License**: Creative Commons Attribution 4.0 International License (CC BY 4.0), which allows for sharing and adaptation with proper credit.
-   **Data Collection**: Data is collected annually and reflects national food supply estimates, providing an overview of average caloric intake per person per day.

#### *caloric_supply* Dataset Structure

The dataset consists of the following columns:

-   **Entity**: The name of the country or region. Code The ISO 3166-1 alpha-3 country code.
-   **Year**: The year of the data observation.
-   **Animal Protein (kcal/person/day)**: Daily per capita caloric supply from animal-based proteins.
-   **Vegetal Protein (kcal/person/day)**: Daily per capita caloric supply from plant-based proteins.
-   **Fat (kcal/person/day)**: Daily per capita caloric supply from fats.
-   **Carbohydrates (kcal/person/day)**: Daily per capita caloric supply from carbohydrates.

Each row represents the average daily caloric intake for a specific country and year, broken down by macronutrient type.

#### Data Limitations

While the dataset provides comprehensive coverage of global dietary patterns, there are some limitations to consider:

-   **Missing Country Codes**: Some regions or combined areas (e.g., "Africa," "Asia") do not have ISO country codes, which may affect regional analyses.
-   **Supply vs. Consumption**: The data represents the food supply rather than actual consumption, as it does not account for food waste, loss during transport, or spoilage.
-   **Annual Aggregation**: The dataset provides annual averages, which do not capture seasonal dietary changes.
-   **Limited Protein Breakdown**: The data only distinguishes between animal-based and plant-based protein sources, without further granularity (e.g., beef vs. chicken for animal protein, or grains vs. legumes for vegetal protein).
-   **Lack of Micronutrient Data**: Vitamins, minerals, and other micronutrients are not represented in this dataset.

## Data Wrangling

#### Renaming Variables

```{r}
#| echo: true 
#| code-fold: true

# Load renamed data
renamed_data <- tar_read(renamed_data)

# Display structure
glimpse(renamed_data)

```

#### Missing Value Analysis

```{r}
#| echo: true 
#| code-fold: true


#Load trimmed data
trimmed_data <- tar_read(trimmed_data)

#Convert empty strings to NA
converted_data <- tar_read(converted_data)

#Detect missing values
missing_values <- tar_read(missing_values)

# Display missing value count
missing_values

```

-   In the entire dataset only variable `Code` has missing values.\
-   It currently has 2661 missing codes, which is 4.5% of the total dataset.

#### Evaluating and Handling Missing values

-   After evaluating the missing values in the dataset, we can see that only column `Code` has missing values. The missing values are primarily associated with `Country` column, which contains regions or combined areas (e.g., "Africa," "Asia") that do not have ISO country codes.
-   For the analysis, we will focus on countries with valid ISO codes and exclude regions or combined areas without specific country codes.
-   Therefore, the following aggregated regions such as FAO regional groups, income categories, and political regions were removed as part of the data cleaning process. These entries represent regional or economic aggregates that do not correspond to specific, identifiable nations. Including them in the analysis would distort country-level comparisons and mask the true performance of individual nations in terms of macronutrient consumption.

```{r}
#| echo: true 
#| code-fold: true


# Load cleaned data after removing regions
cleaned_data <- tar_read(data_cleaned)

#Display missing values after cleaning
post_clean <- tar_read(missing_post_clean)
post_clean
```

#### Duplicates Analysis

```{r}
#| echo: true 
#| code-fold: true

#Duplicate check
duplicate_count <- tar_read(duplicate_check)
duplicate_count

```

-   The data cleaning process revealed no duplicate entries in the dataset. This ensures that each observation is unique and accurately represents a specific country and year combination.

## Exploratory Data Analysis

#### Global Trends in Macronutrient Consumption

```{r}
#| echo: true 
#| code-fold: true

# Load the summarized data by year
summary_data <- tar_read(summary_data)

#Plot global trends in macronutrient consumption
plot_1 <- tar_read(plot_trends)
plot_1

```

This plot shows the absolute values of daily kilocalorie intake per person for each macronutrient (Animal Protein, Vegetal Protein, Fat, and Carbohydrates) from 1960 to 2020. Helps understand the growth in consumption volume over the years, highlighting the rise in fat intake and the relatively stable intake of proteins.

-   Carbohydrates: Carbohydrates have consistently been the largest source of daily energy, providing over 1500 kcal per person per day. While relatively stable, there has been a slow but steady increase over time, suggesting that staples like rice, wheat, and maize continue to be dietary mainstays across the world.

-   Fat Consumption: Fat intake has shown a steady climb since 1961, with sharper increases noticeable after the 1980s. This growth likely reflects shifts towards more processed foods and calorie-dense diets as countries urbanize and food systems globalize. The steady rise in fat consumption suggests changing eating habits that prioritize richer, high-energy foods.

-   Protein Intake: Both animal-based and plant-based proteins have seen modest growth, remaining under 500 kcal per person per day. Animal protein consumption has increased gradually, especially in wealthier nations with rising meat consumption. Vegetal protein remains steady, reflecting its role in more plant-based diets, especially in Asia and Africa.

#### Exploring Top 3 Countries for Animal Protein Consumption by Decade

```{r}
#| echo: true 
#| code-fold: true

#Compute Top 3 for Animal Protein 
top3_animal_protein <- tar_read(top3_animal_protein)

#Plot top 3 countries for Animal Protein by decade
plot_top3_animal_protein <- tar_read(plot_top3_animal_protein)
plot_top3_animal_protein
```

From the Analysis of Animal Protein Consumption by Decade the key observations are as follows:

-   Iceland's Consistent Top Position Iceland consistently ranks as the highest consumer of animal protein per person across all observed decades. The average daily intake in Iceland was 358.1 kcal in 1960 and steadily increased to 426.1 kcal by 2010, with a slight decrease to 421 kcal in 2020. This trend indicates strong dietary reliance on animal-based food sources that has remained stable over time.

-   Shifts in Leading Countries Over Time While Iceland's position remained constant, the second and third spots varied: In the 1960s and 1970s, Australia and New Zealand were prominent, reflecting their strong livestock industries. During the 1980s and 1990s, France emerged as a leading consumer alongside Hong Kong, which continued to rank highly in subsequent decades. By 2020, Mongolia entered the top three for the first time, suggesting increased animal protein consumption in the region.

-   Changes in Consumption Levels The plot indicates an overall increase in animal protein consumption among the top-ranking countries over the six-decade span. Iceland's average intake grew by approximately 68 kcal per person per day from 1960 to 2020, highlighting a steady upward trend. Notably, Hong Kong saw substantial growth, particularly evident from 2010 onwards, indicating rising consumption levels.

#### Macronutrient Proportion Analysis

The stacked area chart illustrates the shifting proportions of global caloric intake from 1961 to 2022. It visualizes how different macronutrients—Animal Protein, Vegetal Protein, Fat, and Carbohydrates, contribute to the global dietary structure over time.

-   The plot represents the proportion of global caloric intake for each macronutrient annually.
-   For each year, the total caloric intake for all countries combined is computed, and the contribution of each macronutrient is expressed as a fraction of this total.
-   This perspective reveals the relative share of each macronutrient in the global diet, highlighting dietary shifts over the decades.
-   The stacked area design effectively captures the long-term trends, such as the steady dominance of carbohydrates, the gradual increase in fat consumption, and the relative stability of protein sources.

```{r}
#| echo: true 
#| code-fold: true


#Aggregating by macronutrient
sum_data <- tar_read(sum_data)

#Calculating proportions
calorie_prop <- tar_read(calorie_prop)

#Converting to wide format
long_prop <- tar_read(long_prop)

#Plot proportions of macronutrients
plot_proportions <- tar_read(plot_proportions)
plot_proportions
```

-   Carbohydrates Remain Dominant: Carbohydrates consistently account for the largest proportion of global caloric intake. Despite some fluctuations, their share has remained relatively stable over six decades, indicating a strong global reliance on carbohydrate-rich staples like grains and starchy vegetables.

-   Gradual Rise in Fat Consumption: The proportion of calories derived from fat has shown a noticeable increase, particularly since the 1980s. This growth reflects dietary shifts towards higher-fat food items, potentially driven by increased consumption of processed foods and oils. The rise is gradual but steady, signaling a global trend towards richer, calorie-dense diets.

-   Stable Share of Animal and Vegetal Protein: The relative contribution of Animal Protein and Vegetal Protein to the total caloric intake has remained largely unchanged. While absolute consumption has grown, their proportional share of the total global caloric intake has not shifted significantly. This indicates that while populations are consuming more food overall, the balance between protein sources remains steady.

Conclusion: The stacked area chart effectively captures long-term global dietary patterns. Carbohydrates continue to be the primary source of global energy intake. Fat consumption, while still secondary, is the only macronutrient with a visibly increasing share. Meanwhile, Animal and Vegetal Protein maintain consistent proportions, reflecting stable dietary roles over the decades.

## Modelling Fat Consumption

The time series for global fat consumption was created using the annual global average fat consumption data from 1961 to 2022. The summary statistics of the time series are as follows:

```{r}
#| echo: true 
#| code-fold: true

# Preparing the data for time series modeling 
fat_ts <- tar_read(fat_ts)

#Summary time series data 
summary_fat_ts <- tar_read(summary_fat_ts)
summary_fat_ts
```

-   Minimum Consumption: 489 kcal per person per day (observed in the early 1960s).
-   1st Quartile: 585 kcal per person per day.
-   Median: 661 kcal per person per day.
-   Mean: 666 kcal per person per day.
-   3rd Quartile: 748 kcal per person per day.
-   Maximum Consumption: 855 kcal per person per day (observed in recent years).

These figures reflect a significant rise in global fat consumption per person over time, with notable accelerations in the 1990s and 2010s. The observed upward trend indicates a gradual increase in dietary fat intake worldwide.

```{r}
#| echo: true 
#| code-fold: true


#Time series plot
plot_fat_ts <- tar_read(plot_fat_ts)
plot_fat_ts

```

-   The time series plot illustrates a steady and relatively linear increase in average fat consumption over the 61-year period. This consistent upward trend suggests a global dietary shift towards higher fat intake, influenced by changes in dietary habits, economic development, and food availability.
-   The slope of the increase indicates a gradual but persistent rise, suggesting that the global trend in fat consumption has not been significantly disrupted by global events during the observed period.
-   The maximum recorded average consumption of 855 kcal per person per day in recent years marks a considerable increase from the early 1960s.

#### ARIMA Model Fit

```{r}
#| echo: true 
#| code-fold: true

# ARIMA model 
fat_arima <- tar_read(fat_arima)

#Model Summary
fat_arima_summary <- tar_read(fat_arima_summary)
fat_arima_summary


```

The ARIMA model selected by auto.arima() for global average fat consumption data is an ARIMA(0,1,0) with drift, indicating that the model captures the trend as a random walk with drift.

**Model Coefficient**

-   Drift: The model estimates an average increase of approximately 6 kcal per year in global average fat consumption. This reflects a gradual and consistent rise in fat intake per person over the decades.
-   Standard Error of Drift: The standard deviation of the drift estimate is approximately 0.64, indicating relatively low variability around the average increase.

**Model Diagnostics**

-   Residual Variance: The variance of the residuals is around 25.17, indicating moderate variability in prediction errors. Log Likelihood: -184.43, suggesting that the model fits the data reasonably well.
-   AIC: 372.87, AICc: 373.08, BIC: 377.09, indicating a well-fitted model without excessive complexity.

**Error Metrics**

-   Mean Error (ME): 0.008 kcal, indicating almost negligible bias.
-   Root Mean Square Error (RMSE): 4.94 kcal, reflecting the average error magnitude.
-   Mean Absolute Error (MAE): 3.60 kcal, showing that the model's average absolute deviation from observed values is minimal.
-   Mean Absolute Percentage Error (MAPE): 0.53%, indicating very high predictive accuracy.
-   Autocorrelation at Lag 1 (ACF1): 0.16, suggesting low autocorrelation in residuals.

#### Forecast

##### Forecast Analysis

```{r}
#| echo: true 
#| code-fold: true

# ARIMA Forecasting
fat_forecast <- tar_read(fat_forecast)

# Plot the forecast
plot_fat_forecast <- tar_read(plot_fat_forecast)
plot_fat_forecast

```

The ARIMA model forecasts that global average fat consumption will continue to increase at an approximate rate of 6 kcal per person per day over the next decade (2023–2032).

-   The solid black line in the plot represents actual global average fat consumption from 1961 to 2022.
-   The blue line shows forecasted values for the next 10 years, indicating a consistent upward trend.
-   The light blue area marks the 80% confidence interval, and the dark blue area marks the 95% confidence interval. These intervals reflect the range within which future values are likely to fall.

#### Predicted vs Actual

```{r}
#| echo: true 
#| code-fold: true

# Load global trends with predictions
global_trends_predicted <- tar_read(global_trends_predicted)

# Plot Actual vs Predicted
plot_actual_vs_predicted <- tar_read(plot_actual_vs_predicted)
plot_actual_vs_predicted
```

-   The plot compares the actual global average fat consumption from 1961 to 2022 with the predicted values from the ARIMA(0,1,0) with drift model.
-   The red line shows observed fat consumption, while the dashed blue line represents predictions.
-   The model accurately captures the upward trend with minimal deviation, demonstrating strong predictive alignment.
-   Minor discrepancies are visible during rapid increases but do not impact overall reliability.
-   Error metrics, RMSE of 4.94, MAE of 3.60, and MAPE of 0.53%, indicate high predictive accuracy.

#### Residual Diagnostics

```{r}
#| echo: true 
#| code-fold: true

# Residuals
residual_diagnostics_test <- tar_read(residual_diagnostics_test)
residual_diagnostics_test


# Residual plot
knitr::include_graphics(tar_read(residual_diagnostics_plot))


```

The ARIMA(0,1,0) with drift model was evaluated using residual diagnostics: - Ljung-Box Test: A p-value of 0.5003 indicates no significant autocorrelation, suggesting the model captured the time-dependent structure well. - Residual Plot: Residuals fluctuate around zero with occasional spikes but remain mostly stable. - ACF Plot: Minimal autocorrelation is observed, with most lags within confidence intervals. - Density Plot: Residuals are approximately normally distributed with slight skew.

Overall, the diagnostics confirm the model's reliability for forecasting global fat consumption.

## Model Output and EDA Discussion

-   The ARIMA(0,1,0) with drift model effectively captures the upward trend in global fat consumption observed in the Global Trends in Macronutrient Consumption (1961 - 2022) plot. The model's estimated drift of 5.99 kcal per person per year aligns with the steady increase shown in the EDA visualization, demonstrating its reliability in modeling long-term growth.

-   The Proportion of Global Caloric Intake by Macronutrient plot highlights fat's rising share over time, which the ARIMA model projects into future periods. While carbohydrates remain dominant and protein sources stable, fat's contribution has grown steadily. The Actual vs. Predicted plot shows strong alignment, with low error metrics (RMSE: 4.94, MAE: 3.60, MAPE: 0.53%), affirming predictive accuracy.

-   Residual diagnostics confirm well-behaved residuals with no significant autocorrelation, validating the model's capacity to capture fat consumption trends effectively.

Overall, the ARIMA model not only matches historical EDA trends but also projects them confidently into the future, demonstrating accuracy and consistency in reflecting global dietary shifts.

## Conclusion

The analysis of global macronutrient consumption from 1961 to 2022 reveals clear trends: carbohydrates remain the largest source of calories, while fat consumption has steadily increased. The ARIMA(0,1,0) model effectively captured this upward trend, forecasting continued growth in fat intake over the next decade. Iceland consistently emerged as the top consumer of animal protein across decades, reflecting stable dietary patterns. Overall, the data indicates persistent global dietary habits, with rising fat consumption pointing to broader nutritional shifts and changing food preferences worldwide.
